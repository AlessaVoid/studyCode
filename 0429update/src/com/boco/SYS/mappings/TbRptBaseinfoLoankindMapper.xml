<?xml version="1.0" encoding="GBK"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- 新报表，机构贷种维度 -->
<mapper namespace="com.boco.SYS.mapper.TbRptBaseinfoLoankindMapper">
	<!-- ##############################################批量生成方法########################################### -->
	<cache readOnly="true"/>
	<!-- 返回列表 -->
    <resultMap id="base_result_map" type="com.boco.SYS.entity.TbRptBaseinfoLoankind">
       	<id column="rpt_date" property="rptDate"/>
       	<id column="rpt_organ" property="rptOrgan"/>
       	<id column="loan_kind" property="loanKind"/>
     	<result column="balance" property="balance"/>
     	<result column="balance_month" property="balanceMonth"/>
     	<result column="balance_season" property="balanceSeason"/>
     	<result column="balance_year" property="balanceYear"/>
     	<result column="day_occ" property="dayOcc"/>
     	<result column="day_expire" property="dayExpire"/>
     	<result column="day_expire_adv" property="dayExpireAdv"/>
     	<result column="day_expire_normal" property="dayExpireNormal"/>
     	<result column="day_increase" property="dayIncrease"/>
     	<result column="month_occ" property="monthOcc"/>
     	<result column="month_expire_estimate" property="monthExpireEstimate"/>
     	<result column="month_expire" property="monthExpire"/>
     	<result column="month_expire_adv" property="monthExpireAdv"/>
     	<result column="month_expire_normal" property="monthExpireNormal"/>
     	<result column="month_expire_estimate_left" property="monthExpireEstimateLeft"/>
     	<result column="month_increase" property="monthIncrease"/>
     	<result column="season_occ" property="seasonOcc"/>
     	<result column="season_expire_estimate" property="seasonExpireEstimate"/>
     	<result column="season_expire" property="seasonExpire"/>
     	<result column="season_expire_adv" property="seasonExpireAdv"/>
     	<result column="season_expire_normal" property="seasonExpireNormal"/>
     	<result column="season_expire_estimate_left" property="seasonExpireEstimateLeft"/>
     	<result column="season_increase" property="seasonIncrease"/>
     	<result column="year_occ" property="yearOcc"/>
     	<result column="year_expire_estimate" property="yearExpireEstimate"/>
     	<result column="year_expire" property="yearExpire"/>
     	<result column="year_expire_adv" property="yearExpireAdv"/>
     	<result column="year_expire_normal" property="yearExpireNormal"/>
     	<result column="year_expire_estimate_left" property="yearExpireEstimateLeft"/>
     	<result column="year_increase" property="yearIncrease"/>
     	<result column="month1_balance" property="month1Balance"/>
     	<result column="month1_count" property="month1Count"/>
     	<result column="month13_balance" property="month13Balance"/>
     	<result column="month13_count" property="month13Count"/>
     	<result column="month36_balance" property="month36Balance"/>
     	<result column="month36_count" property="month36Count"/>
     	<result column="month612_balance" property="month612Balance"/>
     	<result column="month612_count" property="month612Count"/>
     	<result column="year12_balance" property="year12Balance"/>
     	<result column="year12_count" property="year12Count"/>
     	<result column="year23_balance" property="year23Balance"/>
     	<result column="year23_count" property="year23Count"/>
     	<result column="year35_balance" property="year35Balance"/>
     	<result column="year35_count" property="year35Count"/>
     	<result column="year510_balance" property="year510Balance"/>
     	<result column="year510_count" property="year510Count"/>
     	<result column="year10_balance" property="year10Balance"/>
     	<result column="year10_count" property="year10Count"/>
    </resultMap>

	<!-- 列集合 -->
	<sql id="base_column_list">
	    <![CDATA[
        rpt_date ,rpt_organ ,loan_kind ,balance ,balance_month ,balance_season ,balance_year ,day_occ ,day_expire ,day_expire_adv ,day_expire_normal ,day_increase ,month_occ ,month_expire_estimate ,month_expire ,month_expire_adv ,month_expire_normal ,month_expire_estimate_left ,month_increase ,season_occ ,season_expire_estimate ,season_expire ,season_expire_adv ,season_expire_normal ,season_expire_estimate_left ,season_increase ,year_occ ,year_expire_estimate ,year_expire ,year_expire_adv ,year_expire_normal ,year_expire_estimate_left ,year_increase ,month1_balance ,month1_count ,month13_balance ,month13_count ,month36_balance ,month36_count ,month612_balance ,month612_count ,year12_balance ,year12_count ,year23_balance ,year23_count ,year35_balance ,year35_count ,year510_balance ,year510_count ,year10_balance ,year10_count 
	    ]]>
	</sql>
	
	<!-- 新增一条实体 -->
    <insert id="insertEntity" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind">
<!-- 
        <selectKey resultType="java.lang.String" order="BEFORE" keyProperty="id">  
	       SELECT SQ_WEB_PUB.Nextval as ID from DUAL
	    </selectKey>
	    -->       
  INSERT INTO tb_rpt_baseinfo_loankind 
        <trim prefix="(" suffix=")" suffixOverrides=",">
	       	<if test="rptDate != null">
	        	rpt_date ,
	       	</if>
	       	<if test="rptOrgan != null">
	        	rpt_organ ,
	       	</if>
	       	<if test="loanKind != null">
	        	loan_kind ,
	       	</if>
	       	<if test="balance != null">
	        	balance ,
	       	</if>
	       	<if test="balanceMonth != null">
	        	balance_month ,
	       	</if>
	       	<if test="balanceSeason != null">
	        	balance_season ,
	       	</if>
	       	<if test="balanceYear != null">
	        	balance_year ,
	       	</if>
	       	<if test="dayOcc != null">
	        	day_occ ,
	       	</if>
	       	<if test="dayExpire != null">
	        	day_expire ,
	       	</if>
	       	<if test="dayExpireAdv != null">
	        	day_expire_adv ,
	       	</if>
	       	<if test="dayExpireNormal != null">
	        	day_expire_normal ,
	       	</if>
	       	<if test="dayIncrease != null">
	        	day_increase ,
	       	</if>
	       	<if test="monthOcc != null">
	        	month_occ ,
	       	</if>
	       	<if test="monthExpireEstimate != null">
	        	month_expire_estimate ,
	       	</if>
	       	<if test="monthExpire != null">
	        	month_expire ,
	       	</if>
	       	<if test="monthExpireAdv != null">
	        	month_expire_adv ,
	       	</if>
	       	<if test="monthExpireNormal != null">
	        	month_expire_normal ,
	       	</if>
	       	<if test="monthExpireEstimateLeft != null">
	        	month_expire_estimate_left ,
	       	</if>
	       	<if test="monthIncrease != null">
	        	month_increase ,
	       	</if>
	       	<if test="seasonOcc != null">
	        	season_occ ,
	       	</if>
	       	<if test="seasonExpireEstimate != null">
	        	season_expire_estimate ,
	       	</if>
	       	<if test="seasonExpire != null">
	        	season_expire ,
	       	</if>
	       	<if test="seasonExpireAdv != null">
	        	season_expire_adv ,
	       	</if>
	       	<if test="seasonExpireNormal != null">
	        	season_expire_normal ,
	       	</if>
	       	<if test="seasonExpireEstimateLeft != null">
	        	season_expire_estimate_left ,
	       	</if>
	       	<if test="seasonIncrease != null">
	        	season_increase ,
	       	</if>
	       	<if test="yearOcc != null">
	        	year_occ ,
	       	</if>
	       	<if test="yearExpireEstimate != null">
	        	year_expire_estimate ,
	       	</if>
	       	<if test="yearExpire != null">
	        	year_expire ,
	       	</if>
	       	<if test="yearExpireAdv != null">
	        	year_expire_adv ,
	       	</if>
	       	<if test="yearExpireNormal != null">
	        	year_expire_normal ,
	       	</if>
	       	<if test="yearExpireEstimateLeft != null">
	        	year_expire_estimate_left ,
	       	</if>
	       	<if test="yearIncrease != null">
	        	year_increase ,
	       	</if>
	       	<if test="month1Balance != null">
	        	month1_balance ,
	       	</if>
	       	<if test="month1Count != null">
	        	month1_count ,
	       	</if>
	       	<if test="month13Balance != null">
	        	month13_balance ,
	       	</if>
	       	<if test="month13Count != null">
	        	month13_count ,
	       	</if>
	       	<if test="month36Balance != null">
	        	month36_balance ,
	       	</if>
	       	<if test="month36Count != null">
	        	month36_count ,
	       	</if>
	       	<if test="month612Balance != null">
	        	month612_balance ,
	       	</if>
	       	<if test="month612Count != null">
	        	month612_count ,
	       	</if>
	       	<if test="year12Balance != null">
	        	year12_balance ,
	       	</if>
	       	<if test="year12Count != null">
	        	year12_count ,
	       	</if>
	       	<if test="year23Balance != null">
	        	year23_balance ,
	       	</if>
	       	<if test="year23Count != null">
	        	year23_count ,
	       	</if>
	       	<if test="year35Balance != null">
	        	year35_balance ,
	       	</if>
	       	<if test="year35Count != null">
	        	year35_count ,
	       	</if>
	       	<if test="year510Balance != null">
	        	year510_balance ,
	       	</if>
	       	<if test="year510Count != null">
	        	year510_count ,
	       	</if>
	       	<if test="year10Balance != null">
	        	year10_balance ,
	       	</if>
	       	<if test="year10Count != null">
	        	year10_count 
	       	</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
	       	<if test="rptDate != null">
	        	#{rptDate} ,
	       	</if>
	       	<if test="rptOrgan != null">
	        	#{rptOrgan} ,
	       	</if>
	       	<if test="loanKind != null">
	        	#{loanKind} ,
	       	</if>
	       	<if test="balance != null">
	        	#{balance} ,
	       	</if>
	       	<if test="balanceMonth != null">
	        	#{balanceMonth} ,
	       	</if>
	       	<if test="balanceSeason != null">
	        	#{balanceSeason} ,
	       	</if>
	       	<if test="balanceYear != null">
	        	#{balanceYear} ,
	       	</if>
	       	<if test="dayOcc != null">
	        	#{dayOcc} ,
	       	</if>
	       	<if test="dayExpire != null">
	        	#{dayExpire} ,
	       	</if>
	       	<if test="dayExpireAdv != null">
	        	#{dayExpireAdv} ,
	       	</if>
	       	<if test="dayExpireNormal != null">
	        	#{dayExpireNormal} ,
	       	</if>
	       	<if test="dayIncrease != null">
	        	#{dayIncrease} ,
	       	</if>
	       	<if test="monthOcc != null">
	        	#{monthOcc} ,
	       	</if>
	       	<if test="monthExpireEstimate != null">
	        	#{monthExpireEstimate} ,
	       	</if>
	       	<if test="monthExpire != null">
	        	#{monthExpire} ,
	       	</if>
	       	<if test="monthExpireAdv != null">
	        	#{monthExpireAdv} ,
	       	</if>
	       	<if test="monthExpireNormal != null">
	        	#{monthExpireNormal} ,
	       	</if>
	       	<if test="monthExpireEstimateLeft != null">
	        	#{monthExpireEstimateLeft} ,
	       	</if>
	       	<if test="monthIncrease != null">
	        	#{monthIncrease} ,
	       	</if>
	       	<if test="seasonOcc != null">
	        	#{seasonOcc} ,
	       	</if>
	       	<if test="seasonExpireEstimate != null">
	        	#{seasonExpireEstimate} ,
	       	</if>
	       	<if test="seasonExpire != null">
	        	#{seasonExpire} ,
	       	</if>
	       	<if test="seasonExpireAdv != null">
	        	#{seasonExpireAdv} ,
	       	</if>
	       	<if test="seasonExpireNormal != null">
	        	#{seasonExpireNormal} ,
	       	</if>
	       	<if test="seasonExpireEstimateLeft != null">
	        	#{seasonExpireEstimateLeft} ,
	       	</if>
	       	<if test="seasonIncrease != null">
	        	#{seasonIncrease} ,
	       	</if>
	       	<if test="yearOcc != null">
	        	#{yearOcc} ,
	       	</if>
	       	<if test="yearExpireEstimate != null">
	        	#{yearExpireEstimate} ,
	       	</if>
	       	<if test="yearExpire != null">
	        	#{yearExpire} ,
	       	</if>
	       	<if test="yearExpireAdv != null">
	        	#{yearExpireAdv} ,
	       	</if>
	       	<if test="yearExpireNormal != null">
	        	#{yearExpireNormal} ,
	       	</if>
	       	<if test="yearExpireEstimateLeft != null">
	        	#{yearExpireEstimateLeft} ,
	       	</if>
	       	<if test="yearIncrease != null">
	        	#{yearIncrease} ,
	       	</if>
	       	<if test="month1Balance != null">
	        	#{month1Balance} ,
	       	</if>
	       	<if test="month1Count != null">
	        	#{month1Count} ,
	       	</if>
	       	<if test="month13Balance != null">
	        	#{month13Balance} ,
	       	</if>
	       	<if test="month13Count != null">
	        	#{month13Count} ,
	       	</if>
	       	<if test="month36Balance != null">
	        	#{month36Balance} ,
	       	</if>
	       	<if test="month36Count != null">
	        	#{month36Count} ,
	       	</if>
	       	<if test="month612Balance != null">
	        	#{month612Balance} ,
	       	</if>
	       	<if test="month612Count != null">
	        	#{month612Count} ,
	       	</if>
	       	<if test="year12Balance != null">
	        	#{year12Balance} ,
	       	</if>
	       	<if test="year12Count != null">
	        	#{year12Count} ,
	       	</if>
	       	<if test="year23Balance != null">
	        	#{year23Balance} ,
	       	</if>
	       	<if test="year23Count != null">
	        	#{year23Count} ,
	       	</if>
	       	<if test="year35Balance != null">
	        	#{year35Balance} ,
	       	</if>
	       	<if test="year35Count != null">
	        	#{year35Count} ,
	       	</if>
	       	<if test="year510Balance != null">
	        	#{year510Balance} ,
	       	</if>
	       	<if test="year510Count != null">
	        	#{year510Count} ,
	       	</if>
	       	<if test="year10Balance != null">
	        	#{year10Balance} ,
	       	</if>
	       	<if test="year10Count != null">
	        	#{year10Count} 
	       	</if>
        </trim>
    </insert>
    
    <!-- 批量插入 -->
    <insert id="insertBatch" parameterType="java.util.List">
        INSERT INTO tb_rpt_baseinfo_loankind 
        (rpt_date ,rpt_organ ,loan_kind ,balance ,balance_month ,balance_season ,balance_year ,day_occ ,day_expire ,day_expire_adv ,day_expire_normal ,day_increase ,month_occ ,month_expire_estimate ,month_expire ,month_expire_adv ,month_expire_normal ,month_expire_estimate_left ,month_increase ,season_occ ,season_expire_estimate ,season_expire ,season_expire_adv ,season_expire_normal ,season_expire_estimate_left ,season_increase ,year_occ ,year_expire_estimate ,year_expire ,year_expire_adv ,year_expire_normal ,year_expire_estimate_left ,year_increase ,month1_balance ,month1_count ,month13_balance ,month13_count ,month36_balance ,month36_count ,month612_balance ,month612_count ,year12_balance ,year12_count ,year23_balance ,year23_count ,year35_balance ,year35_count ,year510_balance ,year510_count ,year10_balance ,year10_count )
        <foreach collection="list" item="item" index="index" separator="UNION ALL">
        	(SELECT #{item.rptDate,jdbcType=VARCHAR},#{item.rptOrgan,jdbcType=VARCHAR},#{item.loanKind,jdbcType=VARCHAR},#{item.balance,jdbcType=VARCHAR},#{item.balanceMonth,jdbcType=VARCHAR},#{item.balanceSeason,jdbcType=VARCHAR},#{item.balanceYear,jdbcType=VARCHAR},#{item.dayOcc,jdbcType=VARCHAR},#{item.dayExpire,jdbcType=VARCHAR},#{item.dayExpireAdv,jdbcType=VARCHAR},#{item.dayExpireNormal,jdbcType=VARCHAR},#{item.dayIncrease,jdbcType=VARCHAR},#{item.monthOcc,jdbcType=VARCHAR},#{item.monthExpireEstimate,jdbcType=VARCHAR},#{item.monthExpire,jdbcType=VARCHAR},#{item.monthExpireAdv,jdbcType=VARCHAR},#{item.monthExpireNormal,jdbcType=VARCHAR},#{item.monthExpireEstimateLeft,jdbcType=VARCHAR},#{item.monthIncrease,jdbcType=VARCHAR},#{item.seasonOcc,jdbcType=VARCHAR},#{item.seasonExpireEstimate,jdbcType=VARCHAR},#{item.seasonExpire,jdbcType=VARCHAR},#{item.seasonExpireAdv,jdbcType=VARCHAR},#{item.seasonExpireNormal,jdbcType=VARCHAR},#{item.seasonExpireEstimateLeft,jdbcType=VARCHAR},#{item.seasonIncrease,jdbcType=VARCHAR},#{item.yearOcc,jdbcType=VARCHAR},#{item.yearExpireEstimate,jdbcType=VARCHAR},#{item.yearExpire,jdbcType=VARCHAR},#{item.yearExpireAdv,jdbcType=VARCHAR},#{item.yearExpireNormal,jdbcType=VARCHAR},#{item.yearExpireEstimateLeft,jdbcType=VARCHAR},#{item.yearIncrease,jdbcType=VARCHAR},#{item.month1Balance,jdbcType=VARCHAR},#{item.month1Count,jdbcType=VARCHAR},#{item.month13Balance,jdbcType=VARCHAR},#{item.month13Count,jdbcType=VARCHAR},#{item.month36Balance,jdbcType=VARCHAR},#{item.month36Count,jdbcType=VARCHAR},#{item.month612Balance,jdbcType=VARCHAR},#{item.month612Count,jdbcType=VARCHAR},#{item.year12Balance,jdbcType=VARCHAR},#{item.year12Count,jdbcType=VARCHAR},#{item.year23Balance,jdbcType=VARCHAR},#{item.year23Count,jdbcType=VARCHAR},#{item.year35Balance,jdbcType=VARCHAR},#{item.year35Count,jdbcType=VARCHAR},#{item.year510Balance,jdbcType=VARCHAR},#{item.year510Count,jdbcType=VARCHAR},#{item.year10Balance,jdbcType=VARCHAR},#{item.year10Count,jdbcType=VARCHAR} FROM DUAL)
        </foreach>
    </insert>
    
    <!-- 根据主键删除一条记录 -->
    <delete id="deleteByPK" parameterType="java.util.HashMap">
        DELETE FROM tb_rpt_baseinfo_loankind 
        <where>
        	rpt_date = #{rptDate} and
        	rpt_organ = #{rptOrgan} and
        	loan_kind = #{loanKind} 
		</where>
    </delete>
    
    <!-- 根据主键删除一条记录(不抛异常,适用先删除后新增的功能,删除时如果没数据不抛异常) -->
    <delete id="deleteByPKNoException" parameterType="java.util.HashMap">
        DELETE FROM tb_rpt_baseinfo_loankind 
        <where>
        	rpt_date = #{rptDate} and
        	rpt_organ = #{rptOrgan} and
        	loan_kind = #{loanKind} 
		</where>
    </delete>
    
    <!-- 根据主键批量删除记录(只适用单主键的表) -->
    <delete id="deleteBatchByPK" parameterType="java.util.List">
        DELETE FROM tb_rpt_baseinfo_loankind 
        WHERE rpt_daterpt_organloan_kind IN 
        <foreach collection="list" item="item" index="index" open="(" separator="," close=")">
        #{item}
		</foreach>
    </delete>
	
	<!-- 自定义where条件删除，参数为where后的条件字符串，如"id='1' and name='a'" -->    
    <delete id="deleteByWhere" parameterType="java.lang.String">
        DELETE FROM tb_rpt_baseinfo_loankind
        <where>
        	${whereStr}
        </where>
    </delete>

	<!-- 根据主键修改一条记录 -->
    <update id="updateByPK" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind">
        UPDATE tb_rpt_baseinfo_loankind 
        <set>
       	<if test="balance != null">
       		balance = #{balance},
       	</if>
       	<if test="balanceMonth != null">
       		balance_month = #{balanceMonth},
       	</if>
       	<if test="balanceSeason != null">
       		balance_season = #{balanceSeason},
       	</if>
       	<if test="balanceYear != null">
       		balance_year = #{balanceYear},
       	</if>
       	<if test="dayOcc != null">
       		day_occ = #{dayOcc},
       	</if>
       	<if test="dayExpire != null">
       		day_expire = #{dayExpire},
       	</if>
       	<if test="dayExpireAdv != null">
       		day_expire_adv = #{dayExpireAdv},
       	</if>
       	<if test="dayExpireNormal != null">
       		day_expire_normal = #{dayExpireNormal},
       	</if>
       	<if test="dayIncrease != null">
       		day_increase = #{dayIncrease},
       	</if>
       	<if test="monthOcc != null">
       		month_occ = #{monthOcc},
       	</if>
       	<if test="monthExpireEstimate != null">
       		month_expire_estimate = #{monthExpireEstimate},
       	</if>
       	<if test="monthExpire != null">
       		month_expire = #{monthExpire},
       	</if>
       	<if test="monthExpireAdv != null">
       		month_expire_adv = #{monthExpireAdv},
       	</if>
       	<if test="monthExpireNormal != null">
       		month_expire_normal = #{monthExpireNormal},
       	</if>
       	<if test="monthExpireEstimateLeft != null">
       		month_expire_estimate_left = #{monthExpireEstimateLeft},
       	</if>
       	<if test="monthIncrease != null">
       		month_increase = #{monthIncrease},
       	</if>
       	<if test="seasonOcc != null">
       		season_occ = #{seasonOcc},
       	</if>
       	<if test="seasonExpireEstimate != null">
       		season_expire_estimate = #{seasonExpireEstimate},
       	</if>
       	<if test="seasonExpire != null">
       		season_expire = #{seasonExpire},
       	</if>
       	<if test="seasonExpireAdv != null">
       		season_expire_adv = #{seasonExpireAdv},
       	</if>
       	<if test="seasonExpireNormal != null">
       		season_expire_normal = #{seasonExpireNormal},
       	</if>
       	<if test="seasonExpireEstimateLeft != null">
       		season_expire_estimate_left = #{seasonExpireEstimateLeft},
       	</if>
       	<if test="seasonIncrease != null">
       		season_increase = #{seasonIncrease},
       	</if>
       	<if test="yearOcc != null">
       		year_occ = #{yearOcc},
       	</if>
       	<if test="yearExpireEstimate != null">
       		year_expire_estimate = #{yearExpireEstimate},
       	</if>
       	<if test="yearExpire != null">
       		year_expire = #{yearExpire},
       	</if>
       	<if test="yearExpireAdv != null">
       		year_expire_adv = #{yearExpireAdv},
       	</if>
       	<if test="yearExpireNormal != null">
       		year_expire_normal = #{yearExpireNormal},
       	</if>
       	<if test="yearExpireEstimateLeft != null">
       		year_expire_estimate_left = #{yearExpireEstimateLeft},
       	</if>
       	<if test="yearIncrease != null">
       		year_increase = #{yearIncrease},
       	</if>
       	<if test="month1Balance != null">
       		month1_balance = #{month1Balance},
       	</if>
       	<if test="month1Count != null">
       		month1_count = #{month1Count},
       	</if>
       	<if test="month13Balance != null">
       		month13_balance = #{month13Balance},
       	</if>
       	<if test="month13Count != null">
       		month13_count = #{month13Count},
       	</if>
       	<if test="month36Balance != null">
       		month36_balance = #{month36Balance},
       	</if>
       	<if test="month36Count != null">
       		month36_count = #{month36Count},
       	</if>
       	<if test="month612Balance != null">
       		month612_balance = #{month612Balance},
       	</if>
       	<if test="month612Count != null">
       		month612_count = #{month612Count},
       	</if>
       	<if test="year12Balance != null">
       		year12_balance = #{year12Balance},
       	</if>
       	<if test="year12Count != null">
       		year12_count = #{year12Count},
       	</if>
       	<if test="year23Balance != null">
       		year23_balance = #{year23Balance},
       	</if>
       	<if test="year23Count != null">
       		year23_count = #{year23Count},
       	</if>
       	<if test="year35Balance != null">
       		year35_balance = #{year35Balance},
       	</if>
       	<if test="year35Count != null">
       		year35_count = #{year35Count},
       	</if>
       	<if test="year510Balance != null">
       		year510_balance = #{year510Balance},
       	</if>
       	<if test="year510Count != null">
       		year510_count = #{year510Count},
       	</if>
       	<if test="year10Balance != null">
       		year10_balance = #{year10Balance},
       	</if>
       	<if test="year10Count != null">
       		year10_count = #{year10Count},
       	</if>
        </set>
        <where>
        	rpt_date = #{rptDate} and
        	rpt_organ = #{rptOrgan} and
        	loan_kind = #{loanKind} 
        </where>
    </update>
    
    <!-- 批量修改，参数：map(column="XXX"，keyList="XXX")-->
    <update id="updateBatch" parameterType="java.util.HashMap">
	    UPDATE tb_rpt_baseinfo_loankind 
		<set>
        </set>
        WHERE id IN 
	    <foreach collection="keyList" item="item" index="index" open="(" separator="," close=")">
        #{item}
		</foreach>
	</update>
     
    <!-- 自定义where条件修改，参数为where后的条件字符串，如"id='1' and name='a'" -->
    <update id="updateByWhere" parameterType="java.lang.String">
        UPDATE tb_rpt_baseinfo_loankind 
        <set>
       	<if test="rptDate != null">
       		rpt_date = #{rptDate},
       	</if>
       	<if test="rptOrgan != null">
       		rpt_organ = #{rptOrgan},
       	</if>
       	<if test="loanKind != null">
       		loan_kind = #{loanKind},
       	</if>
       	<if test="balance != null">
       		balance = #{balance},
       	</if>
       	<if test="balanceMonth != null">
       		balance_month = #{balanceMonth},
       	</if>
       	<if test="balanceSeason != null">
       		balance_season = #{balanceSeason},
       	</if>
       	<if test="balanceYear != null">
       		balance_year = #{balanceYear},
       	</if>
       	<if test="dayOcc != null">
       		day_occ = #{dayOcc},
       	</if>
       	<if test="dayExpire != null">
       		day_expire = #{dayExpire},
       	</if>
       	<if test="dayExpireAdv != null">
       		day_expire_adv = #{dayExpireAdv},
       	</if>
       	<if test="dayExpireNormal != null">
       		day_expire_normal = #{dayExpireNormal},
       	</if>
       	<if test="dayIncrease != null">
       		day_increase = #{dayIncrease},
       	</if>
       	<if test="monthOcc != null">
       		month_occ = #{monthOcc},
       	</if>
       	<if test="monthExpireEstimate != null">
       		month_expire_estimate = #{monthExpireEstimate},
       	</if>
       	<if test="monthExpire != null">
       		month_expire = #{monthExpire},
       	</if>
       	<if test="monthExpireAdv != null">
       		month_expire_adv = #{monthExpireAdv},
       	</if>
       	<if test="monthExpireNormal != null">
       		month_expire_normal = #{monthExpireNormal},
       	</if>
       	<if test="monthExpireEstimateLeft != null">
       		month_expire_estimate_left = #{monthExpireEstimateLeft},
       	</if>
       	<if test="monthIncrease != null">
       		month_increase = #{monthIncrease},
       	</if>
       	<if test="seasonOcc != null">
       		season_occ = #{seasonOcc},
       	</if>
       	<if test="seasonExpireEstimate != null">
       		season_expire_estimate = #{seasonExpireEstimate},
       	</if>
       	<if test="seasonExpire != null">
       		season_expire = #{seasonExpire},
       	</if>
       	<if test="seasonExpireAdv != null">
       		season_expire_adv = #{seasonExpireAdv},
       	</if>
       	<if test="seasonExpireNormal != null">
       		season_expire_normal = #{seasonExpireNormal},
       	</if>
       	<if test="seasonExpireEstimateLeft != null">
       		season_expire_estimate_left = #{seasonExpireEstimateLeft},
       	</if>
       	<if test="seasonIncrease != null">
       		season_increase = #{seasonIncrease},
       	</if>
       	<if test="yearOcc != null">
       		year_occ = #{yearOcc},
       	</if>
       	<if test="yearExpireEstimate != null">
       		year_expire_estimate = #{yearExpireEstimate},
       	</if>
       	<if test="yearExpire != null">
       		year_expire = #{yearExpire},
       	</if>
       	<if test="yearExpireAdv != null">
       		year_expire_adv = #{yearExpireAdv},
       	</if>
       	<if test="yearExpireNormal != null">
       		year_expire_normal = #{yearExpireNormal},
       	</if>
       	<if test="yearExpireEstimateLeft != null">
       		year_expire_estimate_left = #{yearExpireEstimateLeft},
       	</if>
       	<if test="yearIncrease != null">
       		year_increase = #{yearIncrease},
       	</if>
       	<if test="month1Balance != null">
       		month1_balance = #{month1Balance},
       	</if>
       	<if test="month1Count != null">
       		month1_count = #{month1Count},
       	</if>
       	<if test="month13Balance != null">
       		month13_balance = #{month13Balance},
       	</if>
       	<if test="month13Count != null">
       		month13_count = #{month13Count},
       	</if>
       	<if test="month36Balance != null">
       		month36_balance = #{month36Balance},
       	</if>
       	<if test="month36Count != null">
       		month36_count = #{month36Count},
       	</if>
       	<if test="month612Balance != null">
       		month612_balance = #{month612Balance},
       	</if>
       	<if test="month612Count != null">
       		month612_count = #{month612Count},
       	</if>
       	<if test="year12Balance != null">
       		year12_balance = #{year12Balance},
       	</if>
       	<if test="year12Count != null">
       		year12_count = #{year12Count},
       	</if>
       	<if test="year23Balance != null">
       		year23_balance = #{year23Balance},
       	</if>
       	<if test="year23Count != null">
       		year23_count = #{year23Count},
       	</if>
       	<if test="year35Balance != null">
       		year35_balance = #{year35Balance},
       	</if>
       	<if test="year35Count != null">
       		year35_count = #{year35Count},
       	</if>
       	<if test="year510Balance != null">
       		year510_balance = #{year510Balance},
       	</if>
       	<if test="year510Count != null">
       		year510_count = #{year510Count},
       	</if>
       	<if test="year10Balance != null">
       		year10_balance = #{year10Balance},
       	</if>
       	<if test="year10Count != null">
       		year10_count = #{year10Count},
       	</if>
        </set>
        <where>
       		${whereStr}
       	</where>
    </update>
    
    <!-- 动态where -->
    <sql id="where_equal">
	 	<if test="rptDate != null and rptDate != ''">
	 		and rpt_date = #{rptDate}
	 	</if>
	 	<if test="rptOrgan != null and rptOrgan != ''">
	 		and rpt_organ = #{rptOrgan}
	 	</if>
	 	<if test="loanKind != null and loanKind != ''">
	 		and loan_kind = #{loanKind}
	 	</if>
	 	<if test="balance != null and balance != ''">
	 		and balance = #{balance}
	 	</if>
	 	<if test="balanceMonth != null and balanceMonth != ''">
	 		and balance_month = #{balanceMonth}
	 	</if>
	 	<if test="balanceSeason != null and balanceSeason != ''">
	 		and balance_season = #{balanceSeason}
	 	</if>
	 	<if test="balanceYear != null and balanceYear != ''">
	 		and balance_year = #{balanceYear}
	 	</if>
	 	<if test="dayOcc != null and dayOcc != ''">
	 		and day_occ = #{dayOcc}
	 	</if>
	 	<if test="dayExpire != null and dayExpire != ''">
	 		and day_expire = #{dayExpire}
	 	</if>
	 	<if test="dayExpireAdv != null and dayExpireAdv != ''">
	 		and day_expire_adv = #{dayExpireAdv}
	 	</if>
	 	<if test="dayExpireNormal != null and dayExpireNormal != ''">
	 		and day_expire_normal = #{dayExpireNormal}
	 	</if>
	 	<if test="dayIncrease != null and dayIncrease != ''">
	 		and day_increase = #{dayIncrease}
	 	</if>
	 	<if test="monthOcc != null and monthOcc != ''">
	 		and month_occ = #{monthOcc}
	 	</if>
	 	<if test="monthExpireEstimate != null and monthExpireEstimate != ''">
	 		and month_expire_estimate = #{monthExpireEstimate}
	 	</if>
	 	<if test="monthExpire != null and monthExpire != ''">
	 		and month_expire = #{monthExpire}
	 	</if>
	 	<if test="monthExpireAdv != null and monthExpireAdv != ''">
	 		and month_expire_adv = #{monthExpireAdv}
	 	</if>
	 	<if test="monthExpireNormal != null and monthExpireNormal != ''">
	 		and month_expire_normal = #{monthExpireNormal}
	 	</if>
	 	<if test="monthExpireEstimateLeft != null and monthExpireEstimateLeft != ''">
	 		and month_expire_estimate_left = #{monthExpireEstimateLeft}
	 	</if>
	 	<if test="monthIncrease != null and monthIncrease != ''">
	 		and month_increase = #{monthIncrease}
	 	</if>
	 	<if test="seasonOcc != null and seasonOcc != ''">
	 		and season_occ = #{seasonOcc}
	 	</if>
	 	<if test="seasonExpireEstimate != null and seasonExpireEstimate != ''">
	 		and season_expire_estimate = #{seasonExpireEstimate}
	 	</if>
	 	<if test="seasonExpire != null and seasonExpire != ''">
	 		and season_expire = #{seasonExpire}
	 	</if>
	 	<if test="seasonExpireAdv != null and seasonExpireAdv != ''">
	 		and season_expire_adv = #{seasonExpireAdv}
	 	</if>
	 	<if test="seasonExpireNormal != null and seasonExpireNormal != ''">
	 		and season_expire_normal = #{seasonExpireNormal}
	 	</if>
	 	<if test="seasonExpireEstimateLeft != null and seasonExpireEstimateLeft != ''">
	 		and season_expire_estimate_left = #{seasonExpireEstimateLeft}
	 	</if>
	 	<if test="seasonIncrease != null and seasonIncrease != ''">
	 		and season_increase = #{seasonIncrease}
	 	</if>
	 	<if test="yearOcc != null and yearOcc != ''">
	 		and year_occ = #{yearOcc}
	 	</if>
	 	<if test="yearExpireEstimate != null and yearExpireEstimate != ''">
	 		and year_expire_estimate = #{yearExpireEstimate}
	 	</if>
	 	<if test="yearExpire != null and yearExpire != ''">
	 		and year_expire = #{yearExpire}
	 	</if>
	 	<if test="yearExpireAdv != null and yearExpireAdv != ''">
	 		and year_expire_adv = #{yearExpireAdv}
	 	</if>
	 	<if test="yearExpireNormal != null and yearExpireNormal != ''">
	 		and year_expire_normal = #{yearExpireNormal}
	 	</if>
	 	<if test="yearExpireEstimateLeft != null and yearExpireEstimateLeft != ''">
	 		and year_expire_estimate_left = #{yearExpireEstimateLeft}
	 	</if>
	 	<if test="yearIncrease != null and yearIncrease != ''">
	 		and year_increase = #{yearIncrease}
	 	</if>
	 	<if test="month1Balance != null and month1Balance != ''">
	 		and month1_balance = #{month1Balance}
	 	</if>
	 	<if test="month1Count != null and month1Count != ''">
	 		and month1_count = #{month1Count}
	 	</if>
	 	<if test="month13Balance != null and month13Balance != ''">
	 		and month13_balance = #{month13Balance}
	 	</if>
	 	<if test="month13Count != null and month13Count != ''">
	 		and month13_count = #{month13Count}
	 	</if>
	 	<if test="month36Balance != null and month36Balance != ''">
	 		and month36_balance = #{month36Balance}
	 	</if>
	 	<if test="month36Count != null and month36Count != ''">
	 		and month36_count = #{month36Count}
	 	</if>
	 	<if test="month612Balance != null and month612Balance != ''">
	 		and month612_balance = #{month612Balance}
	 	</if>
	 	<if test="month612Count != null and month612Count != ''">
	 		and month612_count = #{month612Count}
	 	</if>
	 	<if test="year12Balance != null and year12Balance != ''">
	 		and year12_balance = #{year12Balance}
	 	</if>
	 	<if test="year12Count != null and year12Count != ''">
	 		and year12_count = #{year12Count}
	 	</if>
	 	<if test="year23Balance != null and year23Balance != ''">
	 		and year23_balance = #{year23Balance}
	 	</if>
	 	<if test="year23Count != null and year23Count != ''">
	 		and year23_count = #{year23Count}
	 	</if>
	 	<if test="year35Balance != null and year35Balance != ''">
	 		and year35_balance = #{year35Balance}
	 	</if>
	 	<if test="year35Count != null and year35Count != ''">
	 		and year35_count = #{year35Count}
	 	</if>
	 	<if test="year510Balance != null and year510Balance != ''">
	 		and year510_balance = #{year510Balance}
	 	</if>
	 	<if test="year510Count != null and year510Count != ''">
	 		and year510_count = #{year510Count}
	 	</if>
	 	<if test="year10Balance != null and year10Balance != ''">
	 		and year10_balance = #{year10Balance}
	 	</if>
	 	<if test="year10Count != null and year10Count != ''">
	 		and year10_count = #{year10Count}
	 	</if>
    </sql>
    
    <!-- 模糊查询动态where -->
    <sql id="where_like">
 		<if test="rptDate != null and rptDate != ''">
 			and rpt_date like '%' || #{rptDate} || '%'
 		</if>
 		<if test="rptOrgan != null and rptOrgan != ''">
 			and rpt_organ like '%' || #{rptOrgan} || '%'
 		</if>
 		<if test="loanKind != null and loanKind != ''">
 			and loan_kind like '%' || #{loanKind} || '%'
 		</if>
 		<if test="balance != null and balance != ''">
 			and balance like '%' || #{balance} || '%'
 		</if>
 		<if test="balanceMonth != null and balanceMonth != ''">
 			and balance_month like '%' || #{balanceMonth} || '%'
 		</if>
 		<if test="balanceSeason != null and balanceSeason != ''">
 			and balance_season like '%' || #{balanceSeason} || '%'
 		</if>
 		<if test="balanceYear != null and balanceYear != ''">
 			and balance_year like '%' || #{balanceYear} || '%'
 		</if>
 		<if test="dayOcc != null and dayOcc != ''">
 			and day_occ like '%' || #{dayOcc} || '%'
 		</if>
 		<if test="dayExpire != null and dayExpire != ''">
 			and day_expire like '%' || #{dayExpire} || '%'
 		</if>
 		<if test="dayExpireAdv != null and dayExpireAdv != ''">
 			and day_expire_adv like '%' || #{dayExpireAdv} || '%'
 		</if>
 		<if test="dayExpireNormal != null and dayExpireNormal != ''">
 			and day_expire_normal like '%' || #{dayExpireNormal} || '%'
 		</if>
 		<if test="dayIncrease != null and dayIncrease != ''">
 			and day_increase like '%' || #{dayIncrease} || '%'
 		</if>
 		<if test="monthOcc != null and monthOcc != ''">
 			and month_occ like '%' || #{monthOcc} || '%'
 		</if>
 		<if test="monthExpireEstimate != null and monthExpireEstimate != ''">
 			and month_expire_estimate like '%' || #{monthExpireEstimate} || '%'
 		</if>
 		<if test="monthExpire != null and monthExpire != ''">
 			and month_expire like '%' || #{monthExpire} || '%'
 		</if>
 		<if test="monthExpireAdv != null and monthExpireAdv != ''">
 			and month_expire_adv like '%' || #{monthExpireAdv} || '%'
 		</if>
 		<if test="monthExpireNormal != null and monthExpireNormal != ''">
 			and month_expire_normal like '%' || #{monthExpireNormal} || '%'
 		</if>
 		<if test="monthExpireEstimateLeft != null and monthExpireEstimateLeft != ''">
 			and month_expire_estimate_left like '%' || #{monthExpireEstimateLeft} || '%'
 		</if>
 		<if test="monthIncrease != null and monthIncrease != ''">
 			and month_increase like '%' || #{monthIncrease} || '%'
 		</if>
 		<if test="seasonOcc != null and seasonOcc != ''">
 			and season_occ like '%' || #{seasonOcc} || '%'
 		</if>
 		<if test="seasonExpireEstimate != null and seasonExpireEstimate != ''">
 			and season_expire_estimate like '%' || #{seasonExpireEstimate} || '%'
 		</if>
 		<if test="seasonExpire != null and seasonExpire != ''">
 			and season_expire like '%' || #{seasonExpire} || '%'
 		</if>
 		<if test="seasonExpireAdv != null and seasonExpireAdv != ''">
 			and season_expire_adv like '%' || #{seasonExpireAdv} || '%'
 		</if>
 		<if test="seasonExpireNormal != null and seasonExpireNormal != ''">
 			and season_expire_normal like '%' || #{seasonExpireNormal} || '%'
 		</if>
 		<if test="seasonExpireEstimateLeft != null and seasonExpireEstimateLeft != ''">
 			and season_expire_estimate_left like '%' || #{seasonExpireEstimateLeft} || '%'
 		</if>
 		<if test="seasonIncrease != null and seasonIncrease != ''">
 			and season_increase like '%' || #{seasonIncrease} || '%'
 		</if>
 		<if test="yearOcc != null and yearOcc != ''">
 			and year_occ like '%' || #{yearOcc} || '%'
 		</if>
 		<if test="yearExpireEstimate != null and yearExpireEstimate != ''">
 			and year_expire_estimate like '%' || #{yearExpireEstimate} || '%'
 		</if>
 		<if test="yearExpire != null and yearExpire != ''">
 			and year_expire like '%' || #{yearExpire} || '%'
 		</if>
 		<if test="yearExpireAdv != null and yearExpireAdv != ''">
 			and year_expire_adv like '%' || #{yearExpireAdv} || '%'
 		</if>
 		<if test="yearExpireNormal != null and yearExpireNormal != ''">
 			and year_expire_normal like '%' || #{yearExpireNormal} || '%'
 		</if>
 		<if test="yearExpireEstimateLeft != null and yearExpireEstimateLeft != ''">
 			and year_expire_estimate_left like '%' || #{yearExpireEstimateLeft} || '%'
 		</if>
 		<if test="yearIncrease != null and yearIncrease != ''">
 			and year_increase like '%' || #{yearIncrease} || '%'
 		</if>
 		<if test="month1Balance != null and month1Balance != ''">
 			and month1_balance like '%' || #{month1Balance} || '%'
 		</if>
 		<if test="month1Count != null and month1Count != ''">
 			and month1_count like '%' || #{month1Count} || '%'
 		</if>
 		<if test="month13Balance != null and month13Balance != ''">
 			and month13_balance like '%' || #{month13Balance} || '%'
 		</if>
 		<if test="month13Count != null and month13Count != ''">
 			and month13_count like '%' || #{month13Count} || '%'
 		</if>
 		<if test="month36Balance != null and month36Balance != ''">
 			and month36_balance like '%' || #{month36Balance} || '%'
 		</if>
 		<if test="month36Count != null and month36Count != ''">
 			and month36_count like '%' || #{month36Count} || '%'
 		</if>
 		<if test="month612Balance != null and month612Balance != ''">
 			and month612_balance like '%' || #{month612Balance} || '%'
 		</if>
 		<if test="month612Count != null and month612Count != ''">
 			and month612_count like '%' || #{month612Count} || '%'
 		</if>
 		<if test="year12Balance != null and year12Balance != ''">
 			and year12_balance like '%' || #{year12Balance} || '%'
 		</if>
 		<if test="year12Count != null and year12Count != ''">
 			and year12_count like '%' || #{year12Count} || '%'
 		</if>
 		<if test="year23Balance != null and year23Balance != ''">
 			and year23_balance like '%' || #{year23Balance} || '%'
 		</if>
 		<if test="year23Count != null and year23Count != ''">
 			and year23_count like '%' || #{year23Count} || '%'
 		</if>
 		<if test="year35Balance != null and year35Balance != ''">
 			and year35_balance like '%' || #{year35Balance} || '%'
 		</if>
 		<if test="year35Count != null and year35Count != ''">
 			and year35_count like '%' || #{year35Count} || '%'
 		</if>
 		<if test="year510Balance != null and year510Balance != ''">
 			and year510_balance like '%' || #{year510Balance} || '%'
 		</if>
 		<if test="year510Count != null and year510Count != ''">
 			and year510_count like '%' || #{year510Count} || '%'
 		</if>
 		<if test="year10Balance != null and year10Balance != ''">
 			and year10_balance like '%' || #{year10Balance} || '%'
 		</if>
 		<if test="year10Count != null and year10Count != ''">
 			and year10_count like '%' || #{year10Count} || '%'
 		</if>
    </sql>

    <!-- 根据主键查询一条记录 -->
    <select id="selectByPK" parameterType="java.util.HashMap" resultMap="base_result_map" flushCache="true">
	    SELECT <include refid="base_column_list"/>
        FROM tb_rpt_baseinfo_loankind 
        <where> 
        	rpt_date = #{rptDate} and
        	rpt_organ = #{rptOrgan} and
        	loan_kind = #{loanKind} 
        </where>
    </select>
    
    <!-- 根据非主键唯一约束查询记录,没有唯一约束时查询所有记录 -->
    <select id="selectByUQ" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind" resultMap="base_result_map" flushCache="true">
    	SELECT <include refid="base_column_list"/> FROM tb_rpt_baseinfo_loankind
		<where>
		</where>
	</select>
    
    <!-- 根据条件查询记录 -->
    <select id="selectByAttr" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind" resultMap="base_result_map" flushCache="true">
	    SELECT <include refid="base_column_list"/> FROM tb_rpt_baseinfo_loankind 
	    <where>
	   		<include refid="where_equal"/>
	    </where>
	    <if test="sortColumn != null and sortColumn != ''">
    		order by ${sortColumn}
    	</if>
    </select>

	<!-- 根据模糊条件查询记录 -->
    <select id="selectByLikeAttr" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind" resultMap="base_result_map" flushCache="true">
        SELECT <include refid="base_column_list"/> FROM tb_rpt_baseinfo_loankind 
        <where>
        	<include refid="where_like"/>
        </where>
        <if test="sortColumn != null and sortColumn != ''">
    		group by ${sortColumn}
    	</if>
    </select>
    
    <!-- 通过where语句查询 -->
    <select id="selectByWhere" parameterType="java.lang.String" resultMap="base_result_map" flushCache="true">
        SELECT <include refid="base_column_list"/> FROM tb_rpt_baseinfo_loankind 
        <where>
        	${whereStr}
        </where>
    </select>
    
    <!-- 根据条件查询记录数 -->
    <select id="countByAttr" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind" resultType="java.lang.Integer" flushCache="true">
    	select count(*) from tb_rpt_baseinfo_loankind 
    	<where>
    		<include refid="where_equal"/>
    	</where>
    </select>
    
    <!-- 根据模糊条件查询记录数 -->
    <select id="countByLikeAttr" parameterType="com.boco.SYS.entity.TbRptBaseinfoLoankind" resultType="java.lang.Integer" flushCache="true">
    	select count(*) from tb_rpt_baseinfo_loankind 
    	<where>
    		<include refid="where_like"/>
    	</where>
    </select>
    
    <!-- 根据自定义条件查询记录数 -->
    <select id="countByWhere" parameterType="java.lang.String" resultType="java.lang.Integer" flushCache="true">
    	select count(*) from tb_rpt_baseinfo_loankind 
    	<where>
       		${whereStr}
       	</where>
    </select>

    <!-- ##############################################批量生成方法########################################### -->
    
    <!-- ##############################################自定义方法############################################# -->

	<!--查询当前登录机构及其下属机构的数据-->
	<select id="selectByDateAndOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
		SELECT
		r.loan_kind as loan_kind,
		sum (coalesce(r.balance,0)) as balance,
		sum (coalesce(r.balance_month,0)) as balance_month,
		sum (coalesce(r.balance_season,0)) as balance_season,
		sum (coalesce(r.balance_year,0)) as balance_year,
		sum (coalesce(r.day_increase,0))as day_increase,
		sum (coalesce(r.month_increase,0))as month_increase,
		sum (coalesce(r.season_increase,0))as season_increase,
		sum (coalesce(r.year_increase,0))as year_increase,

		sum (coalesce(r.day_occ,0)) as day_occ,
		sum (coalesce(r.day_expire,0)) as day_expire,

		sum (coalesce(r.month_occ,0)) as month_occ,
		sum (coalesce(r.month_expire_estimate,0)) as month_expire_estimate,
		sum (coalesce(r.month_expire,0)) as month_expire,
		sum (coalesce(r.month_expire_estimate_left,0)) as month_expire_estimate_left,

		sum (coalesce(r.season_occ,0)) as season_occ,
		sum (coalesce(r.season_expire_estimate,0)) as season_expire_estimate,
		sum (coalesce(r.season_expire,0)) as season_expire,
		sum (coalesce(r.season_expire_estimate_left,0)) as season_expire_estimate_left,

		sum (coalesce(r.year_occ,0)) as year_occ,
		sum (coalesce(r.year_expire_estimate,0)) as year_expire_estimate,
		sum (coalesce(r.year_expire,0)) as year_expire,
		sum (coalesce(r.year_expire_estimate_left,0)) as year_expire_estimate_left

		FROM tb_rpt_baseinfo_loankind r
		<where>

			<if test="rptOrgan != null and rptOrgan != ''">
			and r.rpt_organ in(
			select o2.thiscode as thiscode
			from fd_organ o
			join fd_organ o1
			on o.thiscode = o1.uporgan or o.thiscode = o1.thiscode
			join fd_organ o2
			on o1.thiscode = o2.uporgan or o1.thiscode = o2.thiscode
			where o.thiscode = '11005293'
			and (o1.thiscode =#{rptOrgan} or o.thiscode= #{rptOrgan})
			)
		</if>
			and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
			select c.comb_code
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
		</where>
		group by r.loan_kind

	</select>

	<!--汇总数据到一分机构维度-->
    <select id="selectByDateAndComb" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">

		select e.*,o.thiscode as  rpt_organ
		from (
			select o.provincecode,
			sum (coalesce(r.balance,0)) as balance,
			sum (coalesce(r.balance_month,0)) as balance_month,
			sum (coalesce(r.balance_season,0)) as balance_season,
			sum (coalesce(r.balance_year,0)) as balance_year,
			sum (coalesce(r.day_increase,0))as day_increase,
			sum (coalesce(r.month_increase,0))as month_increase,
			sum (coalesce(r.season_increase,0))as season_increase,
			sum (coalesce(r.year_increase,0))as year_increase,

			sum (coalesce(r.day_occ,0)) as day_occ,
			sum (coalesce(r.day_expire,0)) as day_expire,

			sum (coalesce(r.month_occ,0)) as month_occ,
			sum (coalesce(r.month_expire_estimate,0)) as month_expire_estimate,
			sum (coalesce(r.month_expire,0)) as month_expire,
			sum (coalesce(r.month_expire_estimate_left,0)) as month_expire_estimate_left,

			sum (coalesce(r.season_occ,0)) as season_occ,
			sum (coalesce(r.season_expire_estimate,0)) as season_expire_estimate,
			sum (coalesce(r.season_expire,0)) as season_expire,
			sum (coalesce(r.season_expire_estimate_left,0)) as season_expire_estimate_left,

			sum (coalesce(r.year_occ,0)) as year_occ,
			sum (coalesce(r.year_expire_estimate,0)) as year_expire_estimate,
			sum (coalesce(r.year_expire,0)) as year_expire,
			sum (coalesce(r.year_expire_estimate_left,0)) as year_expire_estimate_left

			from tb_rpt_baseinfo_loankind r,fd_organ o
			where r.rpt_organ = o.thiscode
			and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
			select c.comb_code
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and rpt_date = #{rptDate}
			</if>
			group by o.provincecode
		) e
		join fd_organ o
		on e.provincecode = o.thiscode
		order by o.leveloneorder

	</select>

	<!--汇总到区域维度-->
	<select id="selectAreaData" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
		select
		concat('area',o.${type}) as  rpt_organ,
		sum (coalesce(e.balance,0)) as balance,
		sum (coalesce(e.balance_month,0)) as balance_month,
		sum (coalesce(e.balance_season,0)) as balance_season,
		sum (coalesce(e.balance_year,0)) as balance_year,
		sum (coalesce(e.day_increase,0))as day_increase,
		sum (coalesce(e.month_increase,0))as month_increase,
		sum (coalesce(e.season_increase,0))as season_increase,
		sum (coalesce(e.year_increase,0))as year_increase,

		sum (coalesce(e.day_occ,0)) as day_occ,
		sum (coalesce(e.day_expire,0)) as day_expire,

		sum (coalesce(e.month_occ,0)) as month_occ,
		sum (coalesce(e.month_expire_estimate,0)) as month_expire_estimate,
		sum (coalesce(e.month_expire,0)) as month_expire,
		sum (coalesce(e.month_expire_estimate_left,0)) as month_expire_estimate_left,

		sum (coalesce(e.season_occ,0)) as season_occ,
		sum (coalesce(e.season_expire_estimate,0)) as season_expire_estimate,
		sum (coalesce(e.season_expire,0)) as season_expire,
		sum (coalesce(e.season_expire_estimate_left,0)) as season_expire_estimate_left,

		sum (coalesce(e.year_occ,0)) as year_occ,
		sum (coalesce(e.year_expire_estimate,0)) as year_expire_estimate,
		sum (coalesce(e.year_expire,0)) as year_expire,
		sum (coalesce(e.year_expire_estimate_left,0)) as year_expire_estimate_left
		from (
			select o.provincecode,
			sum (coalesce(r.balance,0)) as balance,
			sum (coalesce(r.balance_month,0)) as balance_month,
			sum (coalesce(r.balance_season,0)) as balance_season,
			sum (coalesce(r.balance_year,0)) as balance_year,
			sum (coalesce(r.day_increase,0))as day_increase,
			sum (coalesce(r.month_increase,0))as month_increase,
			sum (coalesce(r.season_increase,0))as season_increase,
			sum (coalesce(r.year_increase,0))as year_increase,

			sum (coalesce(r.day_occ,0)) as day_occ,
			sum (coalesce(r.day_expire,0)) as day_expire,

			sum (coalesce(r.month_occ,0)) as month_occ,
			sum (coalesce(r.month_expire_estimate,0)) as month_expire_estimate,
			sum (coalesce(r.month_expire,0)) as month_expire,
			sum (coalesce(r.month_expire_estimate_left,0)) as month_expire_estimate_left,

			sum (coalesce(r.season_occ,0)) as season_occ,
			sum (coalesce(r.season_expire_estimate,0)) as season_expire_estimate,
			sum (coalesce(r.season_expire,0)) as season_expire,
			sum (coalesce(r.season_expire_estimate_left,0)) as season_expire_estimate_left,

			sum (coalesce(r.year_occ,0)) as year_occ,
			sum (coalesce(r.year_expire_estimate,0)) as year_expire_estimate,
			sum (coalesce(r.year_expire,0)) as year_expire,
			sum (coalesce(r.year_expire_estimate_left,0)) as year_expire_estimate_left

			from tb_rpt_baseinfo_loankind r,fd_organ o
			where r.rpt_organ = o.thiscode
			and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
			select c.comb_code
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and rpt_date = #{rptDate}
			</if>
			group by o.provincecode
		) e
		join fd_report_organ o
		on e.provincecode = o.organcode
		group by o.${type}

	</select>

	<!--查询除一分外的其他重点行-->
	<select id="selectOtherKeyOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">

		select r.rpt_organ as rpt_organ,
		sum (coalesce(r.balance,0)) as balance,
		sum (coalesce(r.balance_month,0)) as balance_month,
		sum (coalesce(r.balance_season,0)) as balance_season,
		sum (coalesce(r.balance_year,0)) as balance_year,
		sum (coalesce(r.day_increase,0))as day_increase,
		sum (coalesce(r.month_increase,0))as month_increase,
		sum (coalesce(r.season_increase,0))as season_increase,
		sum (coalesce(r.year_increase,0))as year_increase,

		sum (coalesce(r.day_occ,0)) as day_occ,
		sum (coalesce(r.day_expire,0)) as day_expire,

		sum (coalesce(r.month_occ,0)) as month_occ,
		sum (coalesce(r.month_expire_estimate,0)) as month_expire_estimate,
		sum (coalesce(r.month_expire,0)) as month_expire,
		sum (coalesce(r.month_expire_estimate_left,0)) as month_expire_estimate_left,

		sum (coalesce(r.season_occ,0)) as season_occ,
		sum (coalesce(r.season_expire_estimate,0)) as season_expire_estimate,
		sum (coalesce(r.season_expire,0)) as season_expire,
		sum (coalesce(r.season_expire_estimate_left,0)) as season_expire_estimate_left,

		sum (coalesce(r.year_occ,0)) as year_occ,
		sum (coalesce(r.year_expire_estimate,0)) as year_expire_estimate,
		sum (coalesce(r.year_expire,0)) as year_expire,
		sum (coalesce(r.year_expire_estimate_left,0)) as year_expire_estimate_left

		from tb_rpt_baseinfo_loankind r,fd_organ o
		where r.rpt_organ = o.thiscode
		and r.loan_kind in(
		select c.comb_code
		from tb_report_comb c
		where 1=1
		<if test="combList != null and combList.length > 0">
			and c.comb_code in
			<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		union
		select
		c.comb_code as combcode
		from tb_report_comb c,tb_report_comb_detail cd
		where cd.prod_code = c.comb_code
		and cd.status =1
		<if test="combList != null and combList.length > 0">
			and cd.comb_code in
			<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		union
		select
		c.comb_code as combcode
		from tb_report_comb c, tb_report_comb_detail cd
		where cd.prod_code = c.comb_code
		and cd.status =1
		and cd.comb_code in(
		select c.comb_code
		from tb_report_comb c, tb_report_comb_detail cd
		where cd.prod_code = c.comb_code
		<if test="combList != null and combList.length > 0">
			and cd.comb_code in
			<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		)
		)
		<if test="excludeCombList != null and excludeCombList.length > 0">
			and r.loan_kind not in
			<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		<if test="organList != null and organList.size > 0">
			and r.rpt_organ in
			<foreach collection="organList" index="index" item="organ" open="(" close=")" separator=",">
				#{organ}
			</foreach>
		</if>
		<if test="rptDate != null and rptDate != ''">
			and rpt_date = #{rptDate}
		</if>
		group by r.rpt_organ

	</select>
	<select id="selectLevelOtherOrganDataByDateAndComb" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind">
		select B.*,o.thiscode as  rpt_organ
		from (
		select A.grouporgan,
		sum (coalesce(A.balance,0)) as balance,
		sum (coalesce(A.balance_month,0)) as balance_month,
		sum (coalesce(A.balance_season,0)) as balance_season,
		sum (coalesce(A.balance_year,0)) as balance_year,
		sum (coalesce(A.day_increase,0))as day_increase,
		sum (coalesce(A.month_increase,0))as month_increase,
		sum (coalesce(A.season_increase,0))as season_increase,
		sum (coalesce(A.year_increase,0))as year_increase,

		sum (coalesce(A.day_occ,0)) as day_occ,
		sum (coalesce(A.day_expire,0)) as day_expire,

		sum (coalesce(A.month_occ,0)) as month_occ,
		sum (coalesce(A.month_expire_estimate,0)) as month_expire_estimate,
		sum (coalesce(A.month_expire,0)) as month_expire,
		sum (coalesce(A.month_expire_estimate_left,0)) as month_expire_estimate_left,

		sum (coalesce(A.season_occ,0)) as season_occ,
		sum (coalesce(A.season_expire_estimate,0)) as season_expire_estimate,
		sum (coalesce(A.season_expire,0)) as season_expire,
		sum (coalesce(A.season_expire_estimate_left,0)) as season_expire_estimate_left,

		sum (coalesce(A.year_occ,0)) as year_occ,
		sum (coalesce(A.year_expire_estimate,0)) as year_expire_estimate,
		sum (coalesce(A.year_expire,0)) as year_expire,
		sum (coalesce(A.year_expire_estimate_left,0)) as year_expire_estimate_left
		from (
			select <include refid="base_column_list"/>,
			case when o.organlevel = '3' then o.citycode
				when o.organlevel = '4' then o.branchcode
				else o.areacode
				end as grouporgan
			from tb_rpt_baseinfo_loankind r,fd_organ o
			where r.rpt_organ = o.thiscode
			and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
			select c.comb_code
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
			<if test="organ != null and organ != ''">
				and o.provincecode = #{organ}
			</if>
		) A
		group by A.grouporgan
		) B
		join fd_organ o
		on B.grouporgan = o.thiscode
		order by o.leveloneorder



	</select>
	<select id="selectOrganDataByDateAndOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
		SELECT
		r.loan_kind as loan_kind,
		sum (coalesce(r.balance,0)) as balance,
		sum (coalesce(r.balance_month,0)) as balance_month,
		sum (coalesce(r.balance_season,0)) as balance_season,
		sum (coalesce(r.balance_year,0)) as balance_year,
		sum (coalesce(r.day_increase,0))as day_increase,
		sum (coalesce(r.month_increase,0))as month_increase,
		sum (coalesce(r.season_increase,0))as season_increase,
		sum (coalesce(r.year_increase,0))as year_increase,

		sum (coalesce(r.day_occ,0)) as day_occ,
		sum (coalesce(r.day_expire,0)) as day_expire,

		sum (coalesce(r.month_occ,0)) as month_occ,
		sum (coalesce(r.month_expire_estimate,0)) as month_expire_estimate,
		sum (coalesce(r.month_expire,0)) as month_expire,
		sum (coalesce(r.month_expire_estimate_left,0)) as month_expire_estimate_left,

		sum (coalesce(r.season_occ,0)) as season_occ,
		sum (coalesce(r.season_expire_estimate,0)) as season_expire_estimate,
		sum (coalesce(r.season_expire,0)) as season_expire,
		sum (coalesce(r.season_expire_estimate_left,0)) as season_expire_estimate_left,

		sum (coalesce(r.year_occ,0)) as year_occ,
		sum (coalesce(r.year_expire_estimate,0)) as year_expire_estimate,
		sum (coalesce(r.year_expire,0)) as year_expire,
		sum (coalesce(r.year_expire_estimate_left,0)) as year_expire_estimate_left

		FROM tb_rpt_baseinfo_loankind r
		<where>

			<if test="rptOrgan != null and rptOrgan != ''">
				and r.rpt_organ = #{rptOrgan}
			</if>
			and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
			select c.comb_code
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
		</where>
		group by r.loan_kind

	</select>
	<!--流量表 - 总行登录查询一分机构的数据-->
	<select id="selectDataFlowLevelOneOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
		select
		r.loan_kind as loan_kind,
		o.provincecode as rpt_organ,

		sum(coalesce(r.day_occ,0)) as day_occ,
		sum(coalesce(r.day_expire,0)) as day_expire,
		sum(coalesce(r.day_expire_adv,0)) as day_expire_adv,
		sum(coalesce(r.day_expire_normal,0)) as day_expire_normal,

		sum(coalesce(r.month_occ,0)) as month_occ,
		sum(coalesce(r.month_expire,0)) as month_expire,
		sum(coalesce(r.month_expire_adv,0)) as month_expire_adv,
		sum(coalesce(r.month_expire_normal,0)) as month_expire_normal,

		sum(coalesce(r.season_occ,0)) as season_occ,
		sum(coalesce(r.season_expire,0)) as season_expire,
		sum(coalesce(r.season_expire_adv,0)) as season_expire_adv,
		sum(coalesce(r.season_expire_normal,0)) as season_expire_normal,

		sum(coalesce(r.year_occ,0)) as year_occ,
		sum(coalesce(r.year_expire,0)) as year_expire,
		sum(coalesce(r.year_expire_adv,0)) as year_expire_adv,
		sum(coalesce(r.year_expire_normal,0)) as year_expire_normal

		from tb_rpt_baseinfo_loankind r
		join fd_organ o
		on (o.thiscode = r.rpt_organ)
		where 1=1
		and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
				select c.comb_code
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
			)
		)
		<if test="excludeCombList != null and excludeCombList.length > 0">
			and r.loan_kind not in
			<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		<if test="rptDate != null and rptDate != ''">
			and rpt_date = #{rptDate}
		</if>
		group by r.loan_kind,o.provincecode

	</select>
	<!--流量表 - 总行登录查询一分机构未来的数据-->
	<select id="selectDataFlowLevelOneOrganFuture"  resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
	SELECT
		sum(tl.balance) as day_expire_normal,
		sum(tl.balance) as month_expire_normal,
		sum(tl.balance) as season_expire_normal,
		sum(tl.balance)  as year_expire_normal,
		o.provincecode as rpt_organ,
		cb.comb_code as loan_kind
	FROM
		tb_loan_info tl
		LEFT JOIN tb_report_comb_detail cb on (tl.product_code=cb.prod_code)
		JOIN fd_organ o on (tl.trans_organ=o.thiscode)
	WHERE
		cb.comb_code IN (
			SELECT
				C .comb_code
			FROM
				tb_report_comb C
			WHERE
				1 = 1
		<if test="combList != null and combList.length > 0">
			and c.comb_code in
			<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
			UNION
				SELECT
					C .comb_code AS combcode
				FROM
					tb_report_comb C,
					tb_report_comb_detail cd
				WHERE
					cd.prod_code = C .comb_code
				AND cd.status = 1
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				UNION
					SELECT
						C .comb_code AS combcode
					FROM
						tb_report_comb C,
						tb_report_comb_detail cd
					WHERE
						cd.prod_code = C .comb_code
					AND cd.status = 1
					AND cd.comb_code IN (
						SELECT
							C .comb_code
						FROM
							tb_report_comb C,
							tb_report_comb_detail cd
						WHERE
							cd.prod_code = C .comb_code
									<if test="combList != null and combList.length > 0">
										and cd.comb_code in
										<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
											#{comb}
										</foreach>
									</if>
					)
		)
		<if test="excludeCombList != null and excludeCombList.length > 0">
			and comb_code not in
			<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		and tl.paper_status='0'
		and tl.systemid != '99470000000'
	 	and tl.limit_date BETWEEN #{startDate} and  #{rptDate}
	 	GROUP BY o.provincecode,cb.comb_code
		UNION
		SELECT
		SUM (tl.balance) AS day_expire_normal,
		SUM (tl.balance) AS month_expire_normal,
		SUM (tl.balance) AS season_expire_normal,
		SUM (tl.balance) AS year_expire_normal,
		o.provincecode AS rpt_organ,
		cb.comb_code AS loan_kind
		FROM
		tb_loan_info_detail tl
		LEFT JOIN tb_report_comb_detail cb ON (
		tl.product_code = cb.prod_code
		)
		JOIN fd_organ o ON (tl.trans_organ = o.thiscode)
		WHERE
		tl.paper_status = '0'
		AND tl.limit_date BETWEEN #{ startDate }
		AND #{ rptDate }
		GROUP BY
		o.provincecode,
		cb.comb_code
	</select>
	<!--流量表 - 一分登录查询二分机构的数据-->
	<select id="selectDataFlowLevelOtherOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">

		select
		A.grouporgan as rpt_organ ,
		A.loan_kind as loan_kind,
		sum(coalesce(A.day_occ,0)) as day_occ,
		sum(coalesce(A.day_expire,0)) as day_expire,
		sum(coalesce(A.day_expire_adv,0)) as day_expire_adv,
		sum(coalesce(A.day_expire_normal,0)) as day_expire_normal,

		sum(coalesce(A.month_occ,0)) as month_occ,
		sum(coalesce(A.month_expire,0)) as month_expire,
		sum(coalesce(A.month_expire_adv,0)) as month_expire_adv,
		sum(coalesce(A.month_expire_normal,0)) as month_expire_normal,

		sum(coalesce(A.season_occ,0)) as season_occ,
		sum(coalesce(A.season_expire,0)) as season_expire,
		sum(coalesce(A.season_expire_adv,0)) as season_expire_adv,
		sum(coalesce(A.season_expire_normal,0)) as season_expire_normal,

		sum(coalesce(A.year_occ,0)) as year_occ,
		sum(coalesce(A.year_expire,0)) as year_expire,
		sum(coalesce(A.year_expire_adv,0)) as year_expire_adv,
		sum(coalesce(A.year_expire_normal,0)) as year_expire_normal
		from (
			select <include refid="base_column_list"/>,
			case when o.organlevel = '3' then o.citycode
			when o.organlevel = '4' then o.branchcode
			else o.areacode
			end as grouporgan
			from tb_rpt_baseinfo_loankind r,fd_organ o
			where r.rpt_organ = o.thiscode
			and r.loan_kind in(
				select c.comb_code
				from tb_report_comb c
				where 1=1
				<if test="combList != null and combList.length > 0">
					and c.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c,tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				and cd.comb_code in(
					select c.comb_code
					from tb_report_comb c, tb_report_comb_detail cd
					where cd.prod_code = c.comb_code
					<if test="combList != null and combList.length > 0">
						and cd.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
				)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
			<if test="organ != null and organ != ''">
				and o.provincecode = #{organ}
			</if>
		) A
		group by A.grouporgan,A.loan_kind

	</select>

	<!--流量表 - 一分登录查询二分机构未来的数据 -->
	<select id="selectDataFlowLevelOtherOrganFuture" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true" >
		select
		A.grouporgan as rpt_organ ,
		sum(A.balance) as day_expire_normal,
		sum(A.balance) as month_expire_normal,
		sum(A.balance) as season_expire_normal,
		sum(A.balance)  as year_expire_normal,
		A.loan_kind as loan_kind
		from (
			SELECT
				tl.balance ,
				o.provincecode as rpt_organ,
				cb.comb_code as loan_kind,

			case when o.organlevel = '3' then o.citycode
			when o.organlevel = '4' then o.branchcode
			else o.areacode
			end as grouporgan
			from tb_loan_info tl
			LEFT JOIN tb_report_comb_detail cb on (tl.product_code=cb.prod_code)
			JOIN fd_organ o on (tl.trans_organ=o.thiscode)
			where
			cb.comb_code in(
				select c.comb_code
				from tb_report_comb c
				where 1=1
				<if test="combList != null and combList.length > 0">
					and c.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c,tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				and cd.comb_code in(
				select c.comb_code
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				)
			)
			and tl.paper_status='0'
			and tl.systemid != '99470000000'
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and cb.comb_code not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and tl.limit_date BETWEEN #{startDate} and  #{rptDate}
			</if>
			<if test="organ != null and organ != ''">
				and o.provincecode = #{organ}
			</if>
		union
			SELECT
			tl.balance,
			o.provincecode AS rpt_organ,
			cb.comb_code AS loan_kind,
			CASE
			WHEN o.organlevel = '3' THEN
			o.citycode
			WHEN o.organlevel = '4' THEN
			o.branchcode
			ELSE
			o.areacode
			END AS grouporgan
			FROM
			tb_loan_info_detail tl
			LEFT JOIN tb_report_comb_detail cb ON (
			tl.product_code = cb.prod_code
			)
			JOIN fd_organ o ON (tl.trans_organ = o.thiscode)
			WHERE
			tl.paper_status = '0'
			<if test="rptDate != null and rptDate != ''">
				and tl.limit_date BETWEEN #{startDate} and  #{rptDate}
			</if>
			<if test="organ != null and organ != ''">
				and o.provincecode = #{organ}
			</if>		) A
		group by A.grouporgan,A.loan_kind

	</select>

	<!--流量表 - 区域数据-->
	<select id="selectDataFlowAreaData" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">

		select
		concat('area',o.${type}) as  rpt_organ,
		e.loan_kind as loan_kind,
		sum(coalesce(e.day_occ,0)) as day_occ,
		sum(coalesce(e.day_expire,0)) as day_expire,
		sum(coalesce(e.day_expire_adv,0)) as day_expire_adv,
		sum(coalesce(e.day_expire_normal,0)) as day_expire_normal,

		sum(coalesce(e.month_occ,0)) as month_occ,
		sum(coalesce(e.month_expire,0)) as month_expire,
		sum(coalesce(e.month_expire_adv,0)) as month_expire_adv,
		sum(coalesce(e.month_expire_normal,0)) as month_expire_normal,

		sum(coalesce(e.season_occ,0)) as season_occ,
		sum(coalesce(e.season_expire,0)) as season_expire,
		sum(coalesce(e.season_expire_adv,0)) as season_expire_adv,
		sum(coalesce(e.season_expire_normal,0)) as season_expire_normal,

		sum(coalesce(e.year_occ,0)) as year_occ,
		sum(coalesce(e.year_expire,0)) as year_expire,
		sum(coalesce(e.year_expire_adv,0)) as year_expire_adv,
		sum(coalesce(e.year_expire_normal,0)) as year_expire_normal
		from (
			select
			o.provincecode,
		    r.loan_kind as loan_kind,
			sum(coalesce(r.day_occ,0)) as day_occ,
			sum(coalesce(r.day_expire,0)) as day_expire,
			sum(coalesce(r.day_expire_adv,0)) as day_expire_adv,
			sum(coalesce(r.day_expire_normal,0)) as day_expire_normal,

			sum(coalesce(r.month_occ,0)) as month_occ,
			sum(coalesce(r.month_expire,0)) as month_expire,
			sum(coalesce(r.month_expire_adv,0)) as month_expire_adv,
			sum(coalesce(r.month_expire_normal,0)) as month_expire_normal,

			sum(coalesce(r.season_occ,0)) as season_occ,
			sum(coalesce(r.season_expire,0)) as season_expire,
			sum(coalesce(r.season_expire_adv,0)) as season_expire_adv,
			sum(coalesce(r.season_expire_normal,0)) as season_expire_normal,

			sum(coalesce(r.year_occ,0)) as year_occ,
			sum(coalesce(r.year_expire,0)) as year_expire,
			sum(coalesce(r.year_expire_adv,0)) as year_expire_adv,
			sum(coalesce(r.year_expire_normal,0)) as year_expire_normal

			from tb_rpt_baseinfo_loankind r
			join fd_organ o
			on  r.rpt_organ = o.thiscode
			where 1=1
			and r.loan_kind in(
				select c.comb_code
				from tb_report_comb c
				where 1=1
				<if test="combList != null and combList.length > 0">
					and c.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c,tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				and cd.comb_code in(
					select c.comb_code
					from tb_report_comb c, tb_report_comb_detail cd
					where cd.prod_code = c.comb_code
					<if test="combList != null and combList.length > 0">
						and cd.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
				)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
			group by o.provincecode,r.loan_kind
		) e
		join fd_report_organ o
		on e.provincecode = o.organcode
		group by o.${type},e.loan_kind

	</select>

	<!-- 流量表 - 区域未来数据-->
	<select id="selectDataFlowAreaDataFuture"  resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
			select
				concat('area',o.${type}) as  rpt_organ,
				e.loan_kind as loan_kind,
				SUM (e.day_expire_normal) AS day_expire_normal,
				SUM (e.month_expire_normal) AS month_expire_normal,
				SUM (e.season_expire_normal) AS season_expire_normal,
				SUM (e.year_expire_normal) AS year_expire_normal
				from (
				SELECT
					sum(tl.balance) as day_expire_normal,
					sum(tl.balance) as month_expire_normal,
					sum(tl.balance) as season_expire_normal,
					sum(tl.balance)  as year_expire_normal,
					o.provincecode as rpt_organ,
					cb.comb_code as loan_kind
					FROM
					tb_loan_info tl
					LEFT JOIN tb_report_comb_detail cb on (tl.product_code=cb.prod_code)
					JOIN fd_organ o on (tl.trans_organ=o.thiscode)
					WHERE
					cb.comb_code IN (
					SELECT
					C .comb_code
					FROM
					tb_report_comb C
					WHERE
					1 = 1
					<if test="combList != null and combList.length > 0">
						and c.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
					UNION
					SELECT
					C .comb_code AS combcode
					FROM
					tb_report_comb C,
					tb_report_comb_detail cd
					WHERE
					cd.prod_code = C .comb_code
					AND cd.status = 1
					<if test="combList != null and combList.length > 0">
						and cd.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
					UNION
					SELECT
					C .comb_code AS combcode
					FROM
					tb_report_comb C,
					tb_report_comb_detail cd
					WHERE
					cd.prod_code = C .comb_code
					AND cd.status = 1
					AND cd.comb_code IN (
					SELECT
					C .comb_code
					FROM
					tb_report_comb C,
					tb_report_comb_detail cd
					WHERE
					cd.prod_code = C .comb_code
					<if test="combList != null and combList.length > 0">
						and cd.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
					)
					)
					<if test="excludeCombList != null and excludeCombList.length > 0">
						and comb_code not in
						<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
					
					and limit_date BETWEEN #{startDate} and  #{rptDate}
					and tl.paper_status='0'
					and tl.systemid != '99470000000'
					GROUP BY o.provincecode,cb.comb_code
					union

					SELECT
					SUM (tl.balance) AS day_expire_normal,
					SUM (tl.balance) AS month_expire_normal,
					SUM (tl.balance) AS season_expire_normal,
					SUM (tl.balance) AS year_expire_normal,
					o.provincecode AS rpt_organ,
					cb.comb_code AS loan_kind
					FROM
					tb_loan_info_detail tl
					LEFT JOIN tb_report_comb_detail cb ON (
					tl.product_code = cb.prod_code
					)
					JOIN fd_organ o ON (tl.trans_organ = o.thiscode)
					WHERE
					tl.paper_status='0'
					and tl.limit_date BETWEEN #{startDate} and  #{rptDate}
					GROUP BY
					o.provincecode,
					cb.comb_code
				) e
				JOIN fd_report_organ o ON e.rpt_organ = o.organcode
				GROUP BY o.${type},e.loan_kind
	</select>
	<!--期限表 -总行登录查询一分机构的数据-->
	<select id="selectTimeLimitLevelOneOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind"  flushCache="true">
		select
		o.provincecode as rpt_organ,

		sum(coalesce(r.month1_balance,0)) as month1_balance,
		sum(coalesce(r.month1_count,0)) as month1_count,

		sum(coalesce(r.month13_balance,0)) as month13_balance,
		sum(coalesce(r.month13_count,0)) as month13_count,

		sum(coalesce(r.month36_balance,0)) as month36_balance,
		sum(coalesce(r.month36_count,0)) as month36_count,

		sum(coalesce(r.month612_balance,0)) as month612_balance,
		sum(coalesce(r.month612_count,0)) as month612_count,

		sum(coalesce(r.year12_balance,0)) as year12_balance,
		sum(coalesce(r.year12_count,0)) as year12_count,

		sum(coalesce(r.year23_balance,0)) as year23_balance,
		sum(coalesce(r.year23_count,0)) as year23_count,

		sum(coalesce(r.year35_balance,0)) as year35_balance,
		sum(coalesce(r.year35_count,0)) as year35_count,

		sum(coalesce(r.year510_balance,0)) as year510_balance,
		sum(coalesce(r.year510_count,0)) as year510_count,

		sum(coalesce(r.year10_balance,0)) as year10_balance,
		sum(coalesce(r.year10_count,0)) as year10_count


		from tb_rpt_baseinfo_loankind r
		join fd_organ o
		on (o.thiscode = r.rpt_organ)
		where 1=1

		and r.loan_kind in(
			select c.comb_code
			from tb_report_comb c
			where 1=1
			<if test="combList != null and combList.length > 0">
				and c.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c,tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			<if test="combList != null and combList.length > 0">
				and cd.comb_code in
				<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			union
			select
			c.comb_code as combcode
			from tb_report_comb c, tb_report_comb_detail cd
			where cd.prod_code = c.comb_code
			and cd.status =1
			and cd.comb_code in(
				select c.comb_code
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
			)
		)
		<if test="excludeCombList != null and excludeCombList.length > 0">
			and r.loan_kind not in
			<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
				#{comb}
			</foreach>
		</if>
		<if test="rptDate != null and rptDate != ''">
			and rpt_date = #{rptDate}
		</if>
		group by o.provincecode

	</select>
	<!--期限表 - 一分登录查询二分机构的数据-->
	<select id="selectTimeLimitLevelOtherOrgan" resultType="com.boco.SYS.entity.TbRptBaseinfoLoankind" flushCache="true">
		select
		A.grouporgan as rpt_organ ,
		sum(coalesce(A.month1_balance,0)) as month1_balance,
		sum(coalesce(A.month1_count,0)) as month1_count,

		sum(coalesce(A.month13_balance,0)) as month13_balance,
		sum(coalesce(A.month13_count,0)) as month13_count,

		sum(coalesce(A.month36_balance,0)) as month36_balance,
		sum(coalesce(A.month36_count,0)) as month36_count,

		sum(coalesce(A.month612_balance,0)) as month612_balance,
		sum(coalesce(A.month612_count,0)) as month612_count,

		sum(coalesce(A.year12_balance,0)) as year12_balance,
		sum(coalesce(A.year12_count,0)) as year12_count,

		sum(coalesce(A.year23_balance,0)) as year23_balance,
		sum(coalesce(A.year23_count,0)) as year23_count,

		sum(coalesce(A.year35_balance,0)) as year35_balance,
		sum(coalesce(A.year35_count,0)) as year35_count,

		sum(coalesce(A.year510_balance,0)) as year510_balance,
		sum(coalesce(A.year510_count,0)) as year510_count,

		sum(coalesce(A.year10_balance,0)) as year10_balance,
		sum(coalesce(A.year10_count,0)) as year10_count
		from (
			select <include refid="base_column_list"/>,
			case when o.organlevel = '3' then o.citycode
			when o.organlevel = '4' then o.branchcode
			else o.areacode
			end as grouporgan
			from tb_rpt_baseinfo_loankind r,fd_organ o
			where r.rpt_organ = o.thiscode
			and r.loan_kind in(
				select c.comb_code
				from tb_report_comb c
				where 1=1
				<if test="combList != null and combList.length > 0">
					and c.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c,tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				<if test="combList != null and combList.length > 0">
					and cd.comb_code in
					<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
						#{comb}
					</foreach>
				</if>
				union
				select
				c.comb_code as combcode
				from tb_report_comb c, tb_report_comb_detail cd
				where cd.prod_code = c.comb_code
				and cd.status =1
				and cd.comb_code in(
					select c.comb_code
					from tb_report_comb c, tb_report_comb_detail cd
					where cd.prod_code = c.comb_code
					<if test="combList != null and combList.length > 0">
						and cd.comb_code in
						<foreach collection="combList" index="index" item="comb" open="(" close=")" separator=",">
							#{comb}
						</foreach>
					</if>
				)
			)
			<if test="excludeCombList != null and excludeCombList.length > 0">
				and r.loan_kind not in
				<foreach collection="excludeCombList" index="index" item="comb" open="(" close=")" separator=",">
					#{comb}
				</foreach>
			</if>
			<if test="rptDate != null and rptDate != ''">
				and r.rpt_date = #{rptDate}
			</if>
			<if test="organ != null and organ != ''">
				and o.provincecode = #{organ}
			</if>
		) A
		group by A.grouporgan


	</select>

	<!-- ##############################################自定义方法############################################# -->
</mapper>